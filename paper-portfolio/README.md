# paper-portfolio: Portfolio Construction & Performance Analysis üí∞üìä

`paper-portfolio` is a lightweight yet powerful module within the P.A.P.E.R (Platform for Asset Pricing Experimentation and Research) monorepo. Its core purpose is to leverage the clean, processed data from `paper-data` and the model outputs (checkpoints) from `paper-model` to construct and rigorously evaluate long-short portfolios.

This module focuses on providing tools for cross-sectional portfolio analysis, enabling researchers to visualize and quantify the performance of various investment strategies derived from asset pricing models.

---

## ‚ú® Goals & Features

`paper-portfolio` is designed to provide the final analytical layer in the P.A.P.E.R workflow:

*   **Configurable Portfolio Construction:** üõ†Ô∏è
    *   Utilize a declarative `portfolio-config.yaml` to define portfolio formation rules, including sorting characteristics, breakpoints, and rebalancing frequency.
    *   Support for constructing various types of long-short portfolios (e.g., decile portfolios, characteristic-managed portfolios).
*   **Integration with Processed Data:** üîó
    *   Seamlessly consume the wrangled and augmented datasets generated by `paper-data`, ensuring a consistent and high-quality data foundation.
*   **Leveraging Model Checkpoints:** üß†
    *   Directly ingest model outputs (checkpoints) from `paper-model`, such as predicted returns, factor exposures, or model-implied rankings, to form portfolios.
    *   This allows for direct evaluation of model efficacy in a portfolio context.
*   **Cross-Sectional Performance Evaluation:** üìà
    *   Calculate key performance metrics for constructed portfolios (e.g., average returns, volatility, Sharpe ratio, Sortino ratio, maximum drawdown).
    *   Analyze performance across different cross-sections and time periods.
*   **Visualizations & Reporting:** üìâ
    *   Generate insightful plots to visualize portfolio performance over time (e.g., cumulative returns, drawdowns).
    *   Produce standardized text-based or graphical reports summarizing portfolio characteristics and performance.
*   **Reproducible Analysis:** ‚öôÔ∏è
    *   All portfolio construction and evaluation steps are driven by configuration, ensuring full reproducibility of results.
    *   Detailed logs are maintained to track the entire process.

---

## üöß Status: Under Development

`paper-portfolio` is currently under active development. The foundational components are being established, and the integration with `paper-data` and `paper-model` is being prioritized. Specific portfolio strategies and advanced plotting functionalities will be added incrementally.

---

## üì¶ Installation

`paper-portfolio` is designed to be part of the larger `PAPER` monorepo. You can install it as an optional dependency of `paper-tools` or as a standalone package.

**Recommended (as part of `paper-tools`):**

If you have `paper-tools` installed, you can get `paper-portfolio` and its dependencies using the `portfolio` extra:

```bash
pip install paper-tools[portfolio]
# Or if using uv:
uv pip install paper-tools[portfolio]
```

**Standalone Installation:**

If you only need `paper-portfolio` and its core functionalities (once available), you can install it directly:

```bash
pip install paper-portfolio
# Or if using uv:
uv pip install paper-portfolio
```

**From Source (for development within the monorepo):**

Navigate to the root of your `PAPER` monorepo and install `paper-portfolio` in editable mode:

```bash
cd /path/to/your/PAPER_monorepo
uv pip install -e ./paper-portfolio
```

---

## üìñ Intended Usage Example

The typical workflow for `paper-portfolio` will involve:

1.  **Data Preparation:** Use `paper-data` (orchestrated by `paper execute data`) to process your raw financial data. This will produce the base data for portfolio construction.
2.  **Model Training & Checkpoints:** (Once `paper-model` is ready) Use `paper-model` (orchestrated by `paper execute models`) to train your asset pricing models and generate performance checkpoints (e.g., predicted returns, factor exposures).
3.  **Configuration:** Create and populate your `portfolio-config.yaml` file (e.g., `ThesisExample/configs/portfolio-config.yaml`). This file will specify:
    *   Which processed dataset(s) from `paper-data` to use.
    *   Which model checkpoint(s) from `paper-model` to use for portfolio formation.
    *   Portfolio sorting criteria (e.g., sort by predicted return, by a specific characteristic).
    *   Number of portfolios (e.g., deciles, quintiles).
    *   Rebalancing frequency.
    *   Output paths for performance reports and plots.
4.  **Portfolio Execution:** Run the portfolio phase using the `paper-tools` CLI:

    ```bash
    # From your project root (e.g., ThesisExample/)
    paper execute portfolio
    ```
    This command will trigger `paper-portfolio` to load the configuration, construct the specified portfolios, evaluate their performance, and save the results and plots.

5.  **Review Outputs:**
    *   Check the `logs.log` file in your project root for detailed execution information.
    *   Review the generated performance reports and plots (e.g., in `ThesisExample/portfolios/results/`).

---

## ‚öôÔ∏è Configuration (`portfolio-config.yaml`)

The `portfolio-config.yaml` file will define the rules for portfolio construction and evaluation. While the exact schema is evolving, it will likely include sections for:

*   **`input_data`**: Reference to the processed dataset(s) from `paper-data`.
*   **`model_checkpoints`**: Reference to the model outputs from `paper-model` (e.g., predicted returns).
*   **`portfolio_strategy`**: Defines how portfolios are formed:
    *   `sorting_characteristic`: The column to sort assets by.
    *   `num_portfolios`: Number of portfolios (e.g., 10 for deciles).
    *   `rebalancing_frequency`: How often portfolios are rebalanced (e.g., `monthly`, `quarterly`).
    *   `long_short_definition`: Rules for long and short legs.
*   **`evaluation_metrics`**: Metrics to compute (e.g., `average_return`, `volatility`, `sharpe_ratio`, `max_drawdown`).
*   **`output`**: Settings for saving results:
    *   `reports_path`: Directory for text/table reports.
    *   `plots_path`: Directory for performance plots.
    *   `format`: Output format for reports/plots.

---

## ü§ù Contributing

We welcome contributions to `paper-portfolio`! As this module is under active development, your input can significantly shape its future. If you have suggestions for new portfolio strategies, performance metrics, or visualization techniques, please feel free to:

1.  Fork the repository.
2.  Create a new branch (`git checkout -b feature/YourStrategy`).
3.  Make your changes and write tests.
4.  Commit your changes (`git commit -am 'Add new portfolio strategy'`).
5.  Push to the branch (`git push origin feature/YourStrategy`).
6.  Create a new Pull Request.

---

## üìÑ License

`paper-portfolio` is distributed under the MIT License. See the `LICENSE` file for more information.

---